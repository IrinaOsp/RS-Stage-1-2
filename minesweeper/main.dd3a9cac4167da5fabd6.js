!function(){"use strict";var e={91:function(e){e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},809:function(e,t,o){e.exports=o.p+"assets/favicon-32x32.png"}},t={};function o(n){var l=t[n];if(void 0!==l)return l.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,o),s.exports}o.m=e,o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var l=n.length-1;l>-1&&!e;)e=n[l--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e}(),o.b=document.baseURI||self.location.href;var n={};!function(){o.d(n,{mM:function(){return T},fs:function(){return B},XL:function(){return R},Vk:function(){return q},EP:function(){return k}});var e=o(91),t=o.n(e),l=new URL(o(809),o.b);t()(l);let s,c=0,a=0;function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;console.log("start timer"),s=setInterval((()=>{t++,60===t&&(e++,t=0),0===e&&(document.querySelector(".minutes").textContent="00"),document.querySelector(".minutes").textContent=e<10?"0"+e:e;let o=document.querySelector(".minutes").textContent;document.querySelector(".minutes").textContent=o.slice(o.length-2,o.length),document.querySelector(".seconds").textContent=t<10?"0"+t:t}),1e3)}function i(){console.log("stop timer"),clearInterval(s),s=null,c=0,a=0,document.querySelector(".minutes").textContent="00",document.querySelector(".seconds").textContent="00"}const u=document.createElement("canvas"),m=document.createElement("div"),d=document.createElement("div"),C=document.createElement("button"),h=document.createElement("p");function p(e,t){k[t][e].isOpen||k[t][e].hasFlag||(L.call(T,e,t),S.call(T,e,t))}const b="#EDEEF1",E="#768591";function S(e,t){console.log("start openCell"),document.querySelector("canvas").getContext("2d");const o=k[t][e];o.hasBomb||(L.call(T,e,t),0===o.bombCount&&(0===t?0===e?(p(e+1,t),p(e+1,t+1),p(e,t+1)):e<this.COLS-1?(p(e-1,t),p(e+1,t),p(e-1,t+1),p(e,t+1),p(e+1,t+1)):e===this.COLS-1&&(p(e-1,t),p(e-1,t+1),p(e,t+1)):t===this.ROWS-1?0===e?(p(e+1,t),p(e,t-1),p(e+1,t-1)):e<this.COLS-1?(p(e-1,t),p(e+1,t),p(e-1,t-1),p(e,t-1),p(e+1,t-1)):e===this.COLS-1&&(p(e-1,t),p(e-1,t-1),p(e,t-1)):0===e?(p(e,t-1),p(e+1,t-1),p(e+1,t),p(e,t+1),p(e+1,t+1)):e===this.COLS-1?(p(e-1,t-1),p(e,t-1),p(e-1,t),p(e-1,t+1),p(e,t+1)):(p(e-1,t-1),p(e,t-1),p(e+1,t-1),p(e-1,t),p(e+1,t),p(e-1,t+1),p(e,t+1),p(e+1,t+1))))}function L(e,t){const o=document.querySelector("canvas").getContext("2d");if(!k[t][e].hasFlag&&(k[t][e].isOpen=!0,o.fillStyle=(e+t)%2==0?b:E,o.fillRect(e*this.CELL_SIZE,t*this.CELL_SIZE,this.CELL_SIZE,this.CELL_SIZE),k[t][e].bombCount>0)){switch(k[t][e].bombCount){case 1:o.fillStyle="#3A5FE5";break;case 2:o.fillStyle="#073E1E";break;case 3:o.fillStyle="#f00";break;case 4:o.fillStyle="#1E193C";break;case 5:o.fillStyle="#964B00";break;case 6:o.fillStyle="#0d98ba";break;case 7:o.fillStyle="#000";break;case 8:o.fillStyle="#fff";break;default:console.log("default"),o.fillStyle="#f00"}this.CELL_SIZE<25?(o.font="bold 14px serif",o.fillText(`${k[t][e].bombCount}`,e*this.CELL_SIZE+this.CELL_SIZE/3,t*this.CELL_SIZE+2*this.CELL_SIZE/2.5)):(o.font="bold 20px serif",o.fillText(`${k[t][e].bombCount}`,e*this.CELL_SIZE+this.CELL_SIZE/3,t*this.CELL_SIZE+2*this.CELL_SIZE/3))}}var f=o.p+"assets/bulb.png";const g=new Image;function I(e,t){console.log("start rightClickHandler");const o=Math.floor(e/this.CELL_SIZE),n=Math.floor(t/this.CELL_SIZE),l=document.querySelector("canvas").getContext("2d");if(!k[n][o].isOpen)if(k[n][o].hasFlag){k[n][o].hasFlag=!1,l.clearRect(o*this.CELL_SIZE,n*this.CELL_SIZE,this.CELL_SIZE,this.CELL_SIZE);const e=(n+o)%2==0?B:R;l.fillStyle=e,l.fillRect(o*this.CELL_SIZE,n*this.CELL_SIZE,this.CELL_SIZE,this.CELL_SIZE)}else k[n][o].hasFlag=!0,l.drawImage(g,o*this.CELL_SIZE,n*this.CELL_SIZE,this.CELL_SIZE,this.CELL_SIZE)}g.src=f;var y=o.p+"af7f431108529e51e10e8a7422db4d98.mp3";let v=1;const O=[],_=new Audio(y);var Z=o.p+"f5f70d3f87ce55258f783f13add9a330.mp3",N=o.p+"e3f4933045c6fb6422d52dc2777a6fb2.mp3",w=o.p+"assets/images.jpg";!function(){const e=document.createElement("header");e.className="header",e.textContent="stranger game";const t=document.createElement("div");t.className="wrapper";const o=document.createElement("div");o.className="game-info";const n=document.createElement("select");n.className="select",n.setAttribute("name","select level"),u.className="canvas",document.body.appendChild(e),document.body.appendChild(t),t.appendChild(o),o.appendChild(n),["easy","medium","hard"].forEach((e=>{const t=document.createElement("option");t.className="level-option",t.setAttribute("value",e),t.innerText=e,n.appendChild(t)}));const l=document.createElement("select");l.className="mines-input",l.setAttribute("name","custom mines"),o.appendChild(l);for(let e=10;e<100;e++){const t=document.createElement("option");t.className="mines-num",t.setAttribute("value",e),t.innerText=e,l.appendChild(t)}const s=document.createElement("button");s.className="button new-game-button",s.innerText="NEW GAME",o.appendChild(s);const c=document.createElement("p");c.className="clicks-field",c.innerHTML="number of clicks ",o.appendChild(c);const a=document.createElement("span");a.className="clicks-num",a.innerHTML="0",c.appendChild(a);const i=document.createElement("div");i.className="timer",o.appendChild(i);const m=["00",":","00"];if(localStorage.getItem("Time")){let e=JSON.parse(localStorage.getItem("Time")),t=0;for(let o of e)m[t]=o,t++;r(m[0],m[2])}m.forEach(((e,t)=>{const o=document.createElement("span");o.className="time",0===t?o.classList.add("minutes"):2===t&&o.classList.add("seconds"),o.innerHTML=e,i.appendChild(o)}));const d=document.createElement("button");d.className="button results-button",d.innerHTML="results",o.appendChild(d),t.appendChild(u)}();const x=document.querySelector("canvas").getContext("2d");let q,k=[],M=[],T={CELL_SIZE:35,ROWS:10,COLS:10,BOMB_COUNT:10};const B="#E52A29",R="#040825",W=new Image;function A(){q=0,U=!0,i(),document.querySelector(".clicks-num").innerHTML=q,console.log("start draw"),u.width=this.CELL_SIZE*this.COLS,u.height=this.CELL_SIZE*this.ROWS,k.splice(0,k.length),M.splice(0,M.length);for(let e=0;e<this.ROWS;e++){k.push([]);for(let t=0;t<this.COLS;t++){k[e].push({isOpen:!1,hasBomb:!1,hasFlag:!1,bombCount:0}),this.CELL_SIZE,this.CELL_SIZE;const o=(e+t)%2==0?B:R;x.fillStyle=o,x.fillRect(t*this.CELL_SIZE,e*this.CELL_SIZE,this.CELL_SIZE,this.CELL_SIZE)}}}function H(e,t){console.log("start clickHandler",this.CELL_SIZE),console.log(k);const o=Math.floor(e/this.CELL_SIZE),n=Math.floor(t/this.CELL_SIZE);if(M.length>0){if(console.log("Бомбы уже расставлены"),console.log(k),k[n][o].hasFlag)return;J.call(T,o,n)}else{for(F.call(T);k[n][o].hasBomb;)if(console.log("resort bombs"),M=[],F.call(T),!k[n][o].hasBomb)return void J.call(T,o,n);J.call(T,o,n)}}function F(){console.log("start createBombLayout");for(let e=0;e<this.ROWS;e++)for(let t=0;t<this.COLS;t++)k[e][t].isOpen=!1,k[e][t].hasBomb=!1,k[e][t].hasFlag=!1,k[e][t].bombCount=0;for(;M.length<this.BOMB_COUNT;){const e=Math.floor(Math.random()*this.ROWS),t=Math.floor(Math.random()*this.COLS);k[e][t].hasBomb||(M.push({row:e,col:t}),k[e][t].hasBomb=!0)}for(let e=0;e<this.ROWS;e++)for(let t=0;t<this.COLS;t++)k[e][t].hasBomb&&(0===e?0===t?(k[e][t+1].bombCount+=1,k[e+1][t].bombCount+=1,k[e+1][t+1].bombCount+=1):t<this.COLS-1?(k[e][t-1].bombCount+=1,k[e][t+1].bombCount+=1,k[e+1][t-1].bombCount+=1,k[e+1][t].bombCount+=1,k[e+1][t+1].bombCount+=1):t===this.COLS-1&&(k[e][t-1].bombCount+=1,k[e+1][t-1].bombCount+=1,k[e+1][t].bombCount+=1):e===this.ROWS-1?0===t?(k[e][t+1].bombCount+=1,k[e-1][t].bombCount+=1,k[e-1][t+1].bombCount+=1):t<this.COLS-1?(k[e][t-1].bombCount+=1,k[e][t+1].bombCount+=1,k[e-1][t-1].bombCount+=1,k[e-1][t].bombCount+=1,k[e-1][t+1].bombCount+=1):t===this.COLS-1&&(k[e][t-1].bombCount+=1,k[e-1][t-1].bombCount+=1,k[e-1][t].bombCount+=1):0===t?(k[e-1][t].bombCount+=1,k[e-1][t+1].bombCount+=1,k[e][t+1].bombCount+=1,k[e+1][t].bombCount+=1,k[e+1][t+1].bombCount+=1):t===this.COLS-1?(k[e-1][t-1].bombCount+=1,k[e-1][t].bombCount+=1,k[e][t-1].bombCount+=1,k[e+1][t-1].bombCount+=1,k[e+1][t].bombCount+=1):(k[e-1][t-1].bombCount+=1,k[e-1][t].bombCount+=1,k[e-1][t+1].bombCount+=1,k[e][t-1].bombCount+=1,k[e][t+1].bombCount+=1,k[e+1][t-1].bombCount+=1,k[e+1][t].bombCount+=1,k[e+1][t+1].bombCount+=1));console.log("field"),console.log(k),console.log("bombs"),console.log(M)}W.src=w,u.addEventListener("click",(e=>{const t=e.offsetX,o=e.offsetY;H.call(T,t,o)})),u.addEventListener("contextmenu",(e=>{const t=e.offsetX,o=e.offsetY;e.preventDefault(),I.call(T,t,o)}));let $,U=!0;function J(e,t){console.log("start showField","col "+e,"row "+t,this.CELL_SIZE),U?(console.log("first click"),r()):console.log("second click"),console.log(e,t);const o=k[t][e];o.hasBomb&&(x.drawImage(W,e*this.CELL_SIZE,t*this.CELL_SIZE,this.CELL_SIZE,this.CELL_SIZE),i(),G.play(),m.classList.add("popup-background"),document.body.appendChild(m),m.style.opacity=1,setTimeout((()=>{d.className="popup popup-active",m.appendChild(d),h.className="popup-text popup-active",h.innerHTML="Game over. Try again",d.appendChild(h),C.className="restart-btn button",C.innerHTML="restart game",d.appendChild(C)}),1e3)),o.isOpen||o.hasBomb||(q++,document.querySelector(".clicks-num").textContent="",document.querySelector(".clicks-num").textContent=q,j.play()),S.call(T,e,t),$=0;for(let e=0;e<this.ROWS;e++)for(let t=0;t<this.COLS;t++)k[e][t].isOpen&&($+=1);$===this.COLS*this.ROWS-this.BOMB_COUNT&&function(){m.className="popup-background",document.body.appendChild(m),d.className="popup popup-active",m.appendChild(d);let e=document.querySelector(".minutes").textContent,t=document.querySelector(".seconds").textContent;h.className="popup-text popup-active",h.innerHTML=`Hooray! You found all mines in ${e>0?e+" minutes":""} ${t>0?t+" seconds":""}  and ${q} moves!`,d.appendChild(h),C.className="restart-btn",C.innerHTML="restart game",d.appendChild(C),_.play(),O.push(v),O.push(e),O.push(t),O.push(q);let o=JSON.stringify(O);localStorage.setItem(`game ${v}`,o),v>=10?v=1:v++,O.splice(0,O.length)}(),console.log("openedCells "+$),U=!1}C.addEventListener("click",(e=>{U=!0,A.call(T),i(),d.remove(),h.remove(),m.remove(),G.pause(),_.pause()})),document.querySelector(".new-game-button").addEventListener("click",(e=>{console.log(k),U=!0,A.call(T),i()})),document.querySelector(".select").addEventListener("input",(e=>{switch(e.target.value){case"easy":console.log("easy"),T.CELL_SIZE=35,T.ROWS=10,T.COLS=10,T.BOMB_COUNT=10,document.querySelector(".mines-input").value=10,A.call(T);break;case"medium":console.log("medium"),T.CELL_SIZE=30,T.ROWS=15,T.COLS=15,T.BOMB_COUNT=30,document.querySelector(".mines-input").value=30,A.call(T);break;case"hard":console.log("hard"),window.innerWidth<640?T.CELL_SIZE=15:T.CELL_SIZE=25,T.ROWS=25,T.COLS=25,T.BOMB_COUNT=80,document.querySelector(".mines-input").value=80,A.call(T);break;default:console.log("error on changeGameLvl")}})),document.querySelector(".mines-input").addEventListener("input",(e=>{T.BOMB_COUNT=e.target.value}));const j=new Audio(N),G=new Audio(Z);console.log(typeof G),document.querySelector(".results-button").addEventListener("click",(e=>{const t=[];for(let e=1;e<=10;e++)if(localStorage.getItem(`game ${e}`)){let o=JSON.parse(localStorage.getItem(`game ${e}`));t.push(o)}console.log(t),m.className="popup-background",document.body.appendChild(m),m.style.opacity=1;const o=document.createElement("table");o.className="results-table",m.appendChild(o);const n=document.createElement("thead");o.appendChild(n);const l=document.createElement("tr");n.appendChild(l);const s=document.createElement("tr");n.appendChild(s);const c=document.createElement("th");c.setAttribute("colspan",3),c.textContent="WINNED GAMES",l.appendChild(c);const a=document.createElement("th");a.textContent="GAME #",s.appendChild(a);const r=document.createElement("th");r.textContent="TIME",s.appendChild(r);const i=document.createElement("th");i.textContent="CLICKS",s.appendChild(i);const u=document.createElement("tbody");u.className="results-table-body",o.appendChild(u),t.forEach(((e,t)=>{console.log(e);const o=document.createElement("tr");u.appendChild(o),e.forEach(((e,n)=>{const l=document.createElement("td");0===n?(o.appendChild(l),l.textContent=e):1===n||2===n?1===n?(l.className="results-table-time",o.appendChild(l),l.textContent=e+" : "):2===n&&(console.log(document.querySelectorAll(".results-table-time")[t].textContent),document.querySelectorAll(".results-table-time")[t].textContent+=e):(o.appendChild(l),l.textContent=e)}))})),document.querySelector(".popup-background").addEventListener("click",(e=>{if(m.firstChild.lastChild!==C){for(;m.firstChild;)m.removeChild(m.firstChild);m.remove()}}))})),window.addEventListener("beforeunload",(function(){console.log("start setLocalStorage");let e=JSON.stringify(k);localStorage.setItem("game state",e);let t=JSON.stringify(T);localStorage.setItem("Canvas params",t);let o=document.querySelector(".select").value;localStorage.setItem("game level",o);let n=document.querySelector(".mines-input").value;localStorage.setItem("mines number",n);let l=document.querySelector(".minutes").innerHTML,s=document.querySelector(".seconds").innerHTML,c=JSON.stringify([l,":",s]);localStorage.setItem("Time",c),localStorage.setItem("number of clicks",q)})),window.addEventListener("load",function(){if(console.log("start getLocalStorage"),localStorage.getItem("game state")&&"[]"!==localStorage.getItem("game state")){console.log("has local stor"),U=!1,k=JSON.parse(localStorage.getItem("game state")),T=JSON.parse(localStorage.getItem("Canvas params")),q=localStorage.getItem("number of clicks"),console.log(k),document.querySelector(".clicks-num").textContent=q,document.querySelector(".select").value=localStorage.getItem("game level"),document.querySelector(".mines-input").value=localStorage.getItem("mines number"),u.width=T.CELL_SIZE*T.COLS,u.height=T.CELL_SIZE*T.ROWS;for(let e=0;e<T.ROWS;e++)for(let t=0;t<T.COLS;t++){if(k[e][t].hasBomb&&M.push({i:e,j:t}),!k[e][t].isOpen){const o=(e+t)%2==0?B:R;x.fillStyle=o,x.fillRect(t*T.CELL_SIZE,e*T.CELL_SIZE,T.CELL_SIZE,T.CELL_SIZE)}if(k[e][t].hasFlag){const o=new Image;o.src=f,o.onload=function(){x.drawImage(o,t*T.CELL_SIZE,e*T.CELL_SIZE,T.CELL_SIZE,T.CELL_SIZE)}}k[e][t].isOpen&&L.call(T,t,e)}console.log(k)}else console.log("no local stor"),A.call(T)}.call(T));const P=()=>{window.innerWidth<640?"hard"===document.querySelector(".select").value&&(T.CELL_SIZE=15,A.call(T)):window.innerWidth>=640&&"hard"===document.querySelector(".select").value&&(T.CELL_SIZE=25)};window.addEventListener("resize",P),window.addEventListener("load",P)}()}();